
<p>
	このドキュメントは、コンテンツを構成するドキュメントモジュールの定義を含んだ、Pickles Framework が規定する標準のコーディング規則について説明します。<br />
</p>

<?php
	print( $px->theme()->autoindex() );
?>

<h2>コーディング規則の設計方針</h2>
<p>
	このコーディング規則は、次の方針に基づいて設計されています。<br />
</p>
<ul>
	<li>少数(多くの場合1人)の管理者と、大勢のコンテンツ制作者との間の約束事であり、<strong>管理者が全体を効率よく管理できることを主目的として設計する</strong>。</li>
	<li><strong>学習しやすさを重視する</strong>。可能な限り、素のHTMLの構造のままでマークアップできるように設計する。</li>
	<li>なるべく<strong>ドキュメントの分量を圧縮できるように設計する</strong>。初めてドキュメントを読む人に負担をかけないよう配慮する。また、必要以上の規則を設けることは、個々人の作業効率を下げてしまう原因となる。</li>
</ul>


<h2>ターゲットデバイスについての考え方</h2>

<p>
	ターゲットデバイスの種類については、意識しない(=<strong>マルチデバイスに対応できるように設計する</strong>)ものとします。<br />
</p>

<h2>共通ドキュメントモジュール</h2>

<p>
	ドキュメントモジュールは、構成要素単位で構造化されたHTMLとCSSのセットであり、サイト全体の管理者(=テーマの管理者)により定義され、コンテンツ個別の制作者に配布されるものです。<br />
</p>
<p>
	ここで定義されるドキュメントモジュールは、サイト全体の管理者(=テーマの管理者)により、将来の環境や要件の変化を想定して設計されたものであり、コンテンツ制作者には、そのルールに従ってコンテンツを構築することが求められます。<br />
</p>
<p>
	コンテンツ制作者は、ここに定義されていないドキュメントモジュールを独自に開発することができます(独自ドキュメントモジュール設計規則については<a href="#cont_contents_custom_modules">コンテンツ独自ドキュメントモジュールの定義</a>を参照)が、これは通常推奨されません。独自ドキュメントモジュールを多く開発すると、サイト全体のルールが次第に崩れてくる恐れがあり、管理効率が著しく低下するためです。極力、このドキュメントに定義された、管理者によって設計、提供されたドキュメントモジュールのみを使ってコンテンツを構築するようにしてください。<br />
</p>


<p>共通ドキュメントモジュールは、それぞれ<strong>ユニットモジュール</strong>、<strong>パーツモジュール</strong>、<strong>スタティックモジュール</strong>の3種類のグループに分類されます。</p>

<dl>
	<dt><a href="./units/">ユニットモジュール</a></dt>
		<dd>ユニットモジュールは、水平貫通(コンテンツ領域に対して幅100%)の矩形ブロックで、上下に適切なマージンを与えられたモジュールです。パーツモジュールを内包する入れ物のような役割を果たします(ただし、ユニットモジュール内にユニットモジュールを配置することはできません)。端末の状態(スクリーンの幅など)に合わせて、スタイルが変化する場合があります。</dd>
	<dt><a href="./parts/">パーツモジュール</a></dt>
		<dd>パーツモジュールは、ユニットモジュール内に入れ込んで使うことができます。端末の状態(スクリーンの幅など)に合わせて、スタイルが変化する場合があります。スタティックモジュールと異なり、ある程度複雑な構造のパーツが含まれます。</dd>
	<dt><a href="./statics/">スタティックモジュール</a></dt>
		<dd>スタティックモジュールは、端末の状態(スクリーンの幅など)に影響されず、常に固定の効果を提供します。主に特に基本的でシンプルなショートハンド的なモジュールが含まれます。</dd>
</dl>


<h2>文字セットと改行コード</h2>

<h3>文字セット</h3>
<p>
	テキスト系のファイルタイプ全般において、文字セットは UTF-8(BOMなし) で統一します。<br />
</p>

<h3>改行コード</h3>
<p>
	テキスト系のファイルタイプ全般において、改行コードは CRLF で統一します。<br />
</p>


<h2>命名規則</h2>

<p>次の命名規則を原則とします。</p>

<?php ob_start(); ?>
<style type="text/css">
.cont_exam{
	font-size:90%;
	color:#888888;
}
</style>
<?php $px->theme()->send_content( ob_get_clean(), 'head' ); ?>
<dl>
	<dt>PHP</dt>
		<dd>
			アンダースコア記法で統一する。<br />
			すべて小文字を使用する。<br />
			<span class="cont_exam">例: get_page_info()</span><br />
		</dd>
	<dt>CSS</dt>
		<dd>
			アンダースコア記法を基本とする。<br />
			すべて小文字を使用する。<br />
			数字を使用する場合に、アンダースコアで区切るか否かは任意とする。<br />
			<span class="cont_exam">例: module_name</span><br />
			<p>
				ただし、サブモジュール(モジュールの一部として使用されることが前提となるクラス)については、属するモジュール名の後ろにハイフンでサブモジュール名を付加するように命名します。この場合、サブモジュール名は1つだけ指定できます(ハイフンは1度しか使えません)。<br />
				<span class="cont_exam">例：モジュール module_name に属するサブモジュール module_name-sub1, module_name-sub2 など</span><br />
			</p>
			<p>次にあげるのは、慣例です。</p>
			<dl>
				<dt>*_box</dt>
					<dd>枠がつく・または異なる空間に見えるようにデザインされるモジュールに用います。</dd>
				<dt>*-last</dt>
					<dd>最後の要素につける場合は、このサブモジュール名を用います。</dd>
			</dl>
		</dd>
	<dt>JavaScript</dt>
		<dd>
			キャメル記法に統一する。<br />
			<span class="cont_exam">例:hogeHoge()</span><br />
		</dd>
</dl>




<h3>接頭辞 cont について</h3>
<p>
	接頭辞 cont は、テーマの管理者とコンテンツ制作者の名前領域を分ける目的で、コンテンツ独自のモジュールに対してつける予約語です。<br />
</p>
<p>
	<span class="cont_exam">
	PHPの例: cont_get_page_info()<br />
	CSSの例: cont_module_name<br />
	JavaScriptの例: contHogeHoge()<br />
	</span>
</p>

<h3>名称の省略について</h3>
<p>
	クラス名等の命名に省略形を使用するべきかどうかについて、厳密な取り決めは設けませんが、次のような基準を設け、適切な名称を検討するようにします。<br />
</p>
<ul>
	<li>名称は省略せず、フルスペルで命名することを基本とします。これは、フレームワークに慣れない新しいメンバーでも、ソースコードを見るだけである程度の意味や効果を把握できるように配慮するためです。</li>
	<li>特に頻繁に使用するクラス名には、省略形を用います。これは、タイプする機会が多くなるためミスタイプを防止することにつながること、頻繁に利用するため意味や効果を記憶しやすく、名前から判別しにくくても問題となりにくいことの2点からです。</li>
	<li>頻繁に使うクラスでも、構造が複雑なモジュールには、フルスペルの名称が適しています。これは、モジュール集からコピー＆ペーストしてコーディングする運用が想定されるため、タイピングのコストやミスタイプのリスクが低いと考えられるためです。</li>
</ul>

<h2 id="cont_contents_custom_modules">コンテンツ独自モジュールを定義する場合の規則</h2>

<p>
	サイト全体(テーマ)で一元的に管理されているモジュールと干渉しあわないように、いくつかの規則が用意されています。<br />
	コンテンツ独自のCSS、JavaScriptを定義する場合の規則 についても含みます。<br />
</p>

<h3>独自ファイル格納ディレクトリ</h3>

<p>
	コンテンツファイルと同じ階層に、コンテンツファイルと同じ名前の拡張子を .files に変えた名前のディレクトリが、コンテンツ独自のファイル格納場所です。<br />
	例えば、<code>/abc/def/fhi.html</code> というコンテンツの場合、<code>/abc/def/fhi.files/*</code> を独占的に使うことができます。<br />
</p>

<p>
	外部CSS、画像などのリソースファイルはこの中に管理するようにしてください。また、このディレクトリ内での格納規則や命名規則は設けません。<br />
</p>


<h3>コンテンツ独自CSSを定義する</h3>
<p>
	コンテンツが独自に定義するCSSは、サイト全体(テーマ)で一元的に管理されているCSSと干渉し合っては不都合があります。この問題を避けるため、次の規則が設けられました。<br />
</p>
<ul>
	<li>コンテンツは、<code>&lt;div class=&quot;contents&quot;&gt;&lt;/div&gt;</code> の内側に設置される約束なので、コンテンツが独自に定義するCSSクラスは、.contents 以下にのみ効果があるように記述しなければならない。</li>
	<li>コンテンツが独自に定義するCSSクラスには、接頭辞 cont を付加しなければならない。</li>
	<li>テーマが提供するCSSモジュールの一部を改変して使うことはできない。ただし、テーマが明示的に許可している場合は、その範囲で改変することができる。</li>
</ul>

<p>
	テーマによって特に認められている項目を除き、テーマの共通モジュールの一部を拡張して利用してはいけません。この場合、まずはテーマ管理者に拡張してよいか相談した上で問題ない内容で拡張を行うか、またはモジュール単位で全体をコピーし、サブモジュールも含めて、接頭辞 cont を付加した別のモジュールとして再定義して変更するようにします。<br />
</p>

<p>例:colsを独自CSSとして定義する場合</p>

<div class="unit"><div class="code"><pre><code>&lt;div class=&quot;<strong>cont_</strong>cols unit&quot;&gt;
	&lt;div class=&quot;<strong>cont_</strong>cols-col <strong>cont_</strong>cols-1of2&quot;&gt;&lt;div class=&quot;<strong>cont_</strong>cols-pad&quot;&gt;
		&lt;!-- insert parts modules --&gt;
	&lt;/div&gt;&lt;/div&gt;
	&lt;div class=&quot;<strong>cont_</strong>cols-col <strong>cont_</strong>cols-1of2 <strong>cont_</strong>cols-last&quot;&gt;&lt;div class=&quot;<strong>cont_</strong>cols-pad&quot;&gt;
		&lt;!-- insert parts modules --&gt;
	&lt;/div&gt;&lt;/div&gt;
&lt;/div&gt;&lt;!-- / .<strong>cont_</strong>cols --&gt;
</code></pre></div>
</div>



<h3>コンテンツ独自JavaScriptを定義する</h3>

<p>
	コンテンツは独自にJavaSctiptを記述し、埋め込むことができます。<br />
	ただし、次の規則に従うようにしてください。<br />
</p>
<ul>
	<li>ローカルなJavaScriptメソッドには、接頭辞contを付加する。</li>
	<li>コンテンツのHTMLソースは<code>&lt;div class=&quot;contents&quot;&gt;&lt;/div&gt;</code>に内包される規則のため、それ以外のDOMエレメントを改変するようなスクリプトを記述してはならない。</li>
	<li>コンテンツが独自に定義したエレメントのid属性は、接頭辞contを付加する。</li>
</ul>

<h3>JavaScriptライブラリの利用</h3>
<h4>テーマがロードするJavaScriptライブラリ</h4>
<p>
	以下のライブラリは、テーマにより標準的にロードするため、コンテンツが明示的にロードする必要はありません。<br />
</p>
<ul>
	<li>jQuery (1.7.2)</li>
</ul>

<h4>コンテンツによって必要な場合にロードできる共有ライブラリ</h4>
<p>
	以下のライブラリは、共有リソースとしてテーマによって用意されていますが、特にコンテンツが必要としない限り、ロードはされません。<br />
</p>
<ul>
	<li>(未定義)</li>
</ul>
<ul class="notes">
	<li class="notes-li">※初期状態では、定義された項目はありません。プロジェクトごとに、必要に応じて項目を追加してください。</li>
</ul>

<h3>&lt;head&gt;領域にJavaScriptやCSSを書くには</h3>

<p>
	<code>$px-&gt;theme()-&gt;send_content()</code> を通じて、コンテンツキャビネット <code>head</code> にソースを送ります。<br />
</p>

<div class="unit">
	<div class="code"><pre><code>&lt;?php ob_start(); ?&gt;
&lt;!-- このソースは、テーマのキャビネット &quot;head&quot; に送られます。 --&gt;
&lt;style type=&quot;text/css&quot;&gt;
	/*
		コンテンツ独自のローカルCSSはここに実装します。
	*/
&lt;/style&gt;
&lt;!--
または、次のように、外部のCSSを読み込むこともできます。
---
&lt;link rel=&quot;stylesheet&quot; href=&quot;./index.files/contents.css&quot; type=&quot;text/css&quot; /&gt;
--&gt;
&lt;?php $px-&gt;theme()-&gt;send_content( ob_get_clean(), 'head' ); ?&gt;</code></pre></div>
</div><!-- /.unit -->



