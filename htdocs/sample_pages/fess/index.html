
<p>
	このドキュメントは、コンテンツを構成するドキュメントモジュールの定義を含んだ、FESSが規定する標準のコーディング規則について説明します。<br />
</p>

<?php
	print( $px->theme()->autoindex() );
?>

<h2>ロール(役割)の定義</h2>
<p>
	このドキュメントでは、2種類のロール(役割)が登場します。<br />
</p>
<dl>
	<dt>設計者</dt>
		<dd>設計者は、ウェブサイト全体の構造を設計する役割を担います。多くの場合は、1人〜3人程度で構成される少人数の役割です。制作者へ制作の手順やコーディング規則、ドキュメントモジュール仕様などについて指示し、サイト全体のクオリティを集中的に管理します。役割の呼称は設計者ですが、コンテンツエリア外の領域については設計者が制作を担当します。</dd>
	<dt>制作者</dt>
		<dd>制作者は、コンテンツ(ページ)個別の制作を行います。サイトの規模にもよりますが、通常は設計者に対して人数は多く、5人前後から、大規模なサイトでは数十人規模になることもあります。</dd>
</dl>


<h2>設計方針</h2>
<p>
	ドキュメントモジュールおよびコーディング規則は、次の方針に基づいて設計されます。<br />
</p>
<ul>
	<li>少数(多くの場合1人)の設計者と、大勢の制作者との間の約束事であり、<strong>設計者が全体を効率よく管理できることを主目的として設計する</strong>。</li>
	<li><strong>学習しやすさを重視する</strong>。可能な限り、素のHTMLの構造のままでマークアップできるように設計する。</li>
	<li>なるべく<strong>ドキュメントの分量を圧縮できるように設計する</strong>。初めてドキュメントを読む人に負担をかけないよう配慮する。また、必要以上の規則を設けることは、個々人の作業効率を下げてしまう原因となる。</li>
</ul>


<h2>ターゲットデバイスについての考え方</h2>

<p>
	ターゲットデバイスの種類については、意識しない(=<strong>マルチデバイスに対応できるように設計する</strong>)ものとします。<br />
</p>

<h2>文字セットと改行コード</h2>

<h3>文字セット</h3>
<p>
	テキスト系のファイルタイプ全般において、文字セットは UTF-8(BOMなし) で統一します。<br />
</p>

<h3>改行コード</h3>
<p>
	テキスト系のファイルタイプ全般において、改行コードは CRLF で統一します。<br />
</p>


<h2>命名規則</h2>

<p>次の命名規則を原則とします。</p>

<?php ob_start(); ?>
<style type="text/css">
.cont_exam{
	font-size:90%;
	color:#888888;
}
</style>
<?php $px->theme()->send_content( ob_get_clean(), 'head' ); ?>
<dl>
	<dt>PHP</dt>
		<dd>
			アンダースコア記法で統一する。<br />
			すべて小文字を使用する。<br />
			<span class="cont_exam">例: get_page_info()</span><br />
		</dd>
	<dt>CSS</dt>
		<dd>
			アンダースコア記法を基本とする。<br />
			すべて小文字を使用する。<br />
			数字を使用する場合に、アンダースコアで区切るか否かは任意とする。<br />
			<span class="cont_exam">例: module_name</span><br />
			<p>
				ただし、サブモジュール(モジュールの一部として使用されることが前提となるクラス)については、属するモジュール名の後ろにハイフンでサブモジュール名を付加するように命名します。この場合、サブモジュール名は1つだけ指定できます(ハイフンは1度しか使えません)。<br />
				<span class="cont_exam">例：モジュール module_name に属するサブモジュール module_name-sub1, module_name-sub2 など</span><br />
			</p>
			<p>次にあげるのは、慣例です。</p>
			<dl>
				<dt>*_box</dt>
					<dd>枠がつく・または異なる空間に見えるようにデザインされるモジュールに用います。</dd>
				<dt>*-last</dt>
					<dd>最後の要素につける場合は、このサブモジュール名を用います。</dd>
			</dl>
		</dd>
	<dt>JavaScript</dt>
		<dd>
			キャメル記法に統一する。<br />
			<span class="cont_exam">例:hogeHoge()</span><br />
		</dd>
</dl>


<h3>サブモジュールの定義指針</h3>
<p>
	サブモジュールは、モジュールの一部として使用されることが前提となるクラスです。属するモジュールの名前を冠し、後ろにハイフンでサブモジュール名を付加するように命名します。<br />
</p>
<p>
	基本的な指針としては、属するモジュールの名前領域の内で有効になるよう設計します。<br />
</p>
<p>
	次の例は、モジュール <code>.module</code> と、<code>.module</code> に属するサブモジュール <code>.module-submodule</code> の関係について表しています。<br />
</p>
<div class="unit">
	<div class="code"><pre><code>&lt;style type=&quot;text/css&quot;&gt;
.module{
	/* style */
}
.module .module-submodule{
	/* style */
}
&lt;/style&gt;
&lt;div class=&quot;module&quot;&gt;
    &lt;div class=&quot;module-submodule&quot;&gt;
    	テキスト
    &lt;/div&gt;
&lt;/div&gt;&lt;!-- / .module --&gt;
</code></pre></div>
</div>

<p>
	サブモジュールは、属するモジュールと併記するように設計することもできます。<br />
</p>

<div class="unit">
	<div class="code"><pre><code>&lt;style type=&quot;text/css&quot;&gt;
.module{
	/* style */
}
.module.module-submodule{
	/* style */
}
&lt;/style&gt;
&lt;div class=&quot;module module-submodule&quot;&gt;
	テキスト
&lt;/div&gt;&lt;!-- / .module --&gt;
</code></pre></div>
</div>

<p>
	この場合のサブモジュールの定義は、<code>.module.module-submodule</code> とすることが望ましいですが、IE6などの古い環境を考慮する場合、単に <code>.module-submodule</code> と定義しても構いません。<br />
</p>



<h3>接頭辞 cont について</h3>
<p>
	接頭辞 cont は、設計者と制作者の名前領域を分ける目的で、コンテンツ独自のモジュールに対してつける予約語です。<br />
</p>
<p>
	<span class="cont_exam">
	PHPの例: cont_get_page_info()<br />
	CSSの例: cont_module_name<br />
	JavaScriptの例: contHogeHoge()<br />
	</span>
</p>

<h3>名称の省略について</h3>
<p>
	クラス名等の命名に省略形を使用するべきかどうかについて、厳密な取り決めは設けませんが、次のような基準を設け、適切な名称を検討するようにします。<br />
</p>
<ul>
	<li>名称は省略せず、フルスペルで命名することを基本とします。これは、フレームワークに慣れない新しいメンバーでも、ソースコードを見るだけである程度の意味や効果を把握できるように配慮するためです。</li>
	<li>特に頻繁に使用するクラス名には、省略形を用います。これは、タイプする機会が多くなるためミスタイプを防止することにつながること、頻繁に利用するため意味や効果を記憶しやすく、名前から判別しにくくても問題となりにくいことの2点からです。</li>
	<li>頻繁に使うクラスでも、構造が複雑なモジュールには、フルスペルの名称が適しています。これは、モジュール集からコピー＆ペーストしてコーディングする運用が想定されるため、タイピングのコストやミスタイプのリスクが低いと考えられるためです。</li>
</ul>

<h2>共通ドキュメントモジュール</h2>

<p>
	ドキュメントモジュールは、構成要素単位で構造化されたHTMLとCSSのセットであり、サイト全体の管理者(=設計者)により定義され、コンテンツ個別の制作者に配布されるものです。<br />
</p>
<p>
	ここで定義されるドキュメントモジュールは、サイト全体の管理者(=設計者)により、将来の環境や要件の変化を想定して設計されたものであり、制作者には、そのルールに従ってコンテンツを構築することが求められます。<br />
</p>
<p>
	制作者は、ここに定義されていないドキュメントモジュールを独自に開発することができます(独自ドキュメントモジュール設計規則については<a href="#cont_contents_custom_modules">コンテンツ独自ドキュメントモジュールの定義</a>を参照)が、これは通常推奨されません。独自ドキュメントモジュールを多く開発すると、サイト全体のルールが次第に崩れてくる恐れがあり、管理効率が著しく低下するためです。極力、このドキュメントに定義された、設計者によって設計、提供されたドキュメントモジュールのみを使ってコンテンツを構築するようにしてください。<br />
</p>

<h3>ドキュメントモジュールの4つの分類</h3>
<p>共通ドキュメントモジュールは、それぞれ<strong>ユニットモジュール</strong>、<strong>パーツモジュール</strong>、<strong>スタティックモジュール</strong>、<strong>ボックスモジュール</strong>の4種類のグループに分類されます。</p>

<dl>
	<dt><a href="./units/">ユニットモジュール</a></dt>
		<dd>ユニットモジュールは、水平貫通(コンテンツ領域に対して幅100%)の矩形ブロックで、上下に適切なマージンを与えられたモジュールです。パーツモジュールを内包する入れ物のような役割を果たします(ただし、ユニットモジュール内にユニットモジュールを配置することはできません)。端末の状態(スクリーンの幅など)に合わせて、スタイルが変化する場合があります。</dd>
	<dt><a href="./parts/">パーツモジュール</a></dt>
		<dd>パーツモジュールは、ユニットモジュール内に入れ込んで使うことができます。端末の状態(スクリーンの幅など)に合わせて、スタイルが変化する場合があります。スタティックモジュールと異なり、ある程度複雑な構造のパーツが含まれます。</dd>
	<dt><a href="./statics/">スタティックモジュール</a></dt>
		<dd>スタティックモジュールは、端末の状態(スクリーンの幅など)に影響されず、常に固定の効果を提供します。主に特に基本的でシンプルなショートハンド的なモジュールが含まれます。</dd>
	<dt><a href="./boxes/">ボックスモジュール</a></dt>
		<dd>ボックスモジュールは、箱型に囲われたビジュアルスタイルを持ち、前後の流れから独立した文脈に用います。ユニットモジュールに内包されることができ、ユニットモジュールを内包することもできる特殊なモジュール群です。</dd>
</dl>


<h2 id="cont_contents_custom_modules">コンテンツ独自モジュールを定義する場合の規則</h2>

<p>
	サイト全体(テーマ)で一元的に管理されているモジュールと干渉しあわないように、いくつかの規則が用意されています。<br />
	コンテンツ独自のCSS、JavaScriptを定義する場合の規則 についても含みます。<br />
</p>

<h3>独自ファイル格納ディレクトリ</h3>

<p>
	コンテンツファイルと同じ階層に、コンテンツファイルと同じ名前の拡張子を .files に変えた名前のディレクトリが、コンテンツ独自のファイル格納場所です。<br />
	例えば、<code>/abc/def/fhi.html</code> というコンテンツの場合、<code>/abc/def/fhi.files/*</code> を独占的に使うことができます。<br />
</p>

<p>
	外部CSS、画像などのリソースファイルはこの中に管理するようにしてください。また、このディレクトリ内での格納規則や命名規則は設けません。<br />
</p>

<ul class="notes">
	<li class="notes-li">※ディレクトリ共通の独自ファイルを設計する必要がある場合、そのディレクトリの管理者を決めるなど運用ルールを設けたうえで、この規則を調整してください。<br />
	例えば、<code>/abc/def/*.html</code> という複数のコンテンツで使う独自ファイルを、<code>/abc/def/common/*</code> とするなどしてください。<br /></li>
		<!-- editor comment: common.files は common.html が占有するため、この目的には使えません。 -->
</ul>

<h3>コンテンツ独自CSSを定義する</h3>
<p>
	コンテンツが独自に定義するCSSは、サイト全体(テーマ)で一元的に管理されているCSSと干渉し合っては不都合があります。この問題を避けるため、次の規則が設けられました。<br />
</p>
<ul>
	<li>コンテンツは、<code>&lt;div class=&quot;contents&quot;&gt;&lt;/div&gt;</code> の内側に設置される約束なので、コンテンツが独自に定義するCSSクラスは、.contents 以下にのみ効果があるように記述しなければならない。</li>
	<li>コンテンツが独自に定義するCSSクラスには、接頭辞 cont を付加しなければならない。</li>
	<li>テーマが提供するCSSモジュールの一部を改変して使うことはできない。ただし、テーマが明示的に許可している場合は、その範囲で改変することができる。</li>
</ul>

<p>
	テーマによって特に認められている項目を除き、テーマの共通モジュールの一部を拡張して利用してはいけません。この場合、まずは設計者に拡張してよいか相談した上で問題ない内容で拡張を行うか、またはモジュール単位で全体をコピーし、サブモジュールも含めて、接頭辞 cont を付加した別のモジュールとして再定義して変更するようにします。<br />
</p>

<p>例:colsを独自CSSとして定義する場合</p>

<div class="unit"><div class="code"><pre><code>&lt;div class=&quot;<strong>cont_</strong>cols unit&quot;&gt;
	&lt;div class=&quot;<strong>cont_</strong>cols-col <strong>cont_</strong>cols-1of2&quot;&gt;&lt;div class=&quot;<strong>cont_</strong>cols-pad&quot;&gt;
		&lt;!-- insert parts modules --&gt;
	&lt;/div&gt;&lt;/div&gt;
	&lt;div class=&quot;<strong>cont_</strong>cols-col <strong>cont_</strong>cols-1of2 <strong>cont_</strong>cols-last&quot;&gt;&lt;div class=&quot;<strong>cont_</strong>cols-pad&quot;&gt;
		&lt;!-- insert parts modules --&gt;
	&lt;/div&gt;&lt;/div&gt;
&lt;/div&gt;&lt;!-- / .<strong>cont_</strong>cols --&gt;
</code></pre></div>
</div>



<h3>コンテンツ独自JavaScriptを定義する</h3>

<p>
	コンテンツは独自にJavaSctiptを記述し、埋め込むことができます。<br />
	ただし、次の規則に従うようにしてください。<br />
</p>
<ul>
	<li>ローカルなJavaScriptメソッドには、接頭辞contを付加する。</li>
	<li>コンテンツのHTMLソースは<code>&lt;div class=&quot;contents&quot;&gt;&lt;/div&gt;</code>に内包される規則のため、それ以外のDOMエレメントを改変するようなスクリプトを記述してはならない。</li>
	<li>コンテンツが独自に定義したエレメントのid属性は、接頭辞contを付加する。</li>
</ul>

<h3>JavaScriptライブラリの利用</h3>
<h4>テーマがロードするJavaScriptライブラリ</h4>
<p>
	以下のライブラリは、テーマにより標準的にロードするため、コンテンツが明示的にロードする必要はありません。<br />
</p>
<ul>
	<li>jQuery (1.10.1)</li>
</ul>

<h4>コンテンツによって必要な場合にロードできる共有ライブラリ</h4>
<p>
	以下のライブラリは、共有リソースとしてテーマによって用意されていますが、特にコンテンツが必要としない限り、ロードはされません。<br />
</p>
<ul>
	<li>未定義(必要に応じて設計者が追加)</li>
</ul>



